{"version":3,"sources":["../src/cubism_ctrl.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAQ,sB,kBAAA,gB;;AACD,O;;AACA,S;;AACA,e;;;;;;;;;;;;;;;;;;;;;iCAEM,e;;;AAEX,iCAAY,MAAZ,EAAoB,SAApB,EAA+B,UAA/B,EAA2C;AAAA;;AAAA,yGACnC,MADmC,EAC3B,SAD2B;;AAEzC,gBAAK,UAAL,GAAkB,UAAlB;AACA,gBAAK,IAAL,GAAY,EAAZ;;AAEA,cAAI,gBAAgB;AAClB,mBAAO,EADW;AAElB,wBAAY,IAFM;AAGlB,sBAAU,IAHQ;AAIlB,qBAAS,CAAC,EAAD,CAJS;AAKlB,0BAAc,IALI;AAMlB,2BAAe,WANG;AAOlB,yBAAa,EAPK;AAQlB,oBAAQ,OARU;AASlB,uBAAW,SATO;AAUlB,sBAAU;AAVQ,WAApB;;AAaA,YAAE,QAAF,CAAW,MAAK,KAAhB,EAAuB,aAAvB;AACA,YAAE,QAAF,CAAW,MAAK,KAAL,CAAW,MAAtB,EAA8B,cAAc,MAA5C;;AAEA,gBAAK,MAAL,CAAY,EAAZ,CAAe,eAAf,EAAgC,MAAK,cAAL,CAAoB,IAApB,OAAhC;AACA,gBAAK,MAAL,CAAY,EAAZ,CAAe,YAAf,EAA6B,MAAK,WAAL,CAAiB,IAAjB,OAA7B;AACA,gBAAK,MAAL,CAAY,EAAZ,CAAe,oBAAf,EAAqC,MAAK,cAAL,CAAoB,IAApB,OAArC;AACA,gBAAK,MAAL,CAAY,EAAZ,CAAe,gBAAf,EAAiC,MAAK,cAAL,CAAoB,IAApB,OAAjC;AAxByC;AAyB1C;;;;2CAEgB;AACf,iBAAK,YAAL,CAAkB,SAAlB,EAA6B,iDAA7B,EAAgF,CAAhF;AACA,iBAAK,WAAL,GAAmB,IAAI,cAAJ,EAAnB;AACD;;;wCAEa,O,EAAS;AACrB,iBAAK,KAAL,CAAW,MAAX,GAAoB,QAAQ,KAA5B;AACA,iBAAK,MAAL;AACD;;;wCAEa;AACZ,iBAAK,IAAL,GAAY,EAAZ;AACA,iBAAK,MAAL;AACD;;;4CAEiB,M,EAAQ,K,EAAO;AAC/B,mBAAO,KAAP,GAAe,KAAf;AACA,iBAAK,KAAL,CAAW,WAAX,CAAuB,OAAO,KAA9B,IAAuC,OAAO,KAA9C;AACA,iBAAK,MAAL;AACD;;;yCAEc,Q,EAAU;AACvB,iBAAK,IAAL,GAAY,QAAZ;AACA,iBAAK,MAAL,CAAY,KAAK,IAAjB;AACD;;;+BAGI,K,EAAO,I,EAAM,K,EAAO,I,EAAM;AAC7B,sBAAU,KAAV,EAAiB,IAAjB,EAAuB,KAAvB,EAA8B,IAA9B;AACD;;;;QA1DkC,gB;;;;AA6DrC,sBAAgB,WAAhB,GAA8B,aAA9B","file":"cubism_ctrl.js","sourcesContent":["import {MetricsPanelCtrl} from 'app/plugins/sdk';\nimport _ from 'lodash';\nimport kbn from 'app/core/utils/kbn';\nimport rendering from './rendering';\n\nexport class CubismChartCtrl extends MetricsPanelCtrl {\n\n  constructor($scope, $injector, $rootScope) {\n    super($scope, $injector);\n    this.$rootScope = $rootScope;\n    this.data = [];\n\n    var panelDefaults = {\n      links: [],\n      datasource: null,\n      interval: null,\n      targets: [{}],\n      cacheTimeout: null,\n      nullPointMode: 'connected',\n      aliasColors: {},\n      format: 'short',\n      valueName: 'current',\n      fontSize: '80%'\n    };\n\n    _.defaults(this.panel, panelDefaults);\n    _.defaults(this.panel.legend, panelDefaults.legend);\n\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Options', 'public/plugins/grafana-cubism-panel/editor.html', 2);\n    this.unitFormats = kbn.getUnitFormats();\n  }\n\n  setUnitFormat(subItem) {\n    this.panel.format = subItem.value;\n    this.render();\n  }\n\n  onDataError() {\n    this.data = [];\n    this.render();\n  }\n\n  changeSeriesColor(series, color) {\n    series.color = color;\n    this.panel.aliasColors[series.alias] = series.color;\n    this.render();\n  }\n\n  onDataReceived(dataList) {\n    this.data = dataList;\n    this.render(this.data);\n  }\n\n  //noinspection JSMethodCanBeStatic\n  link(scope, elem, attrs, ctrl) {\n    rendering(scope, elem, attrs, ctrl);\n  }\n}\n\nCubismChartCtrl.templateUrl = 'module.html';\n"]}